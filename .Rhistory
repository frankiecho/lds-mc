pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
## Plot change in contiguity
contiguity <- read_csv('output/contiguity_baseline_100.csv') |>
filter(alpha <= 30)
contiguity |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_hline(yintercept = 0, color = 'gray50') +
#geom_ribbon(aes(ymin = min, ymax = max, x = alpha, fill = name), alpha = 0.15) +
geom_hline(yintercept = 0, color = 'gray50') +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Connectivity index", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
coord_cartesian(expand = F) +
theme(legend.title = element_blank())
ggsave("plots/contiguity_plot.png", units = 'cm', width = 20, height = 12)
ggsave("plots/contiguity_plot.png", units = 'cm', width = 12, height = 12)
contiguity |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('mstd', 'cvar', 'ev'), c("M-SD", "M-CVaR", "EV"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_hline(yintercept = 0, color = 'gray50') +
#geom_ribbon(aes(ymin = min, ymax = max, x = alpha, fill = name), alpha = 0.15) +
geom_hline(yintercept = 0, color = 'gray50') +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Connectivity index", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
coord_cartesian(expand = F) +
theme(legend.title = element_blank())
plot11 <- ce_df |>
dplyr::select(-cvar_mstd) |>
pivot_longer(c('ev', 'cvar', 'mstd'), names_to = 'name', values_to = 'value') |>
mutate(name = factor(name, c('mstd', 'cvar', 'ev'), c("M-SD", "M-CVaR", "EV"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
geom_hline(yintercept = 0, color = 'gray50') +
#geom_ribbon(aes(ymin = min, ymax = max, x = alpha, fill = name), alpha = 0.15) +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_y_continuous("Change from baseline", labels = scales::percent) +
scale_x_continuous("θ") +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
coord_cartesian(expand = F) +
theme(legend.title = element_blank())
plot12 <- ce_df |>
dplyr::select(c(-ev, -cvar, -mstd)) |>
rename(value = cvar_mstd) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
geom_hline(yintercept = 0) +
#geom_ribbon(aes(ymin = min, ymax = max, x = alpha), alpha = 0.15) +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha), alpha = 0.2) +
geom_line(aes(x = alpha, y = median)) +
geom_hline(yintercept = 0, color = 'gray50') +
scale_y_continuous("Change from M-SD", labels = scales::percent) +
scale_x_continuous("θ") +
coord_cartesian(expand = F) +
ggpubr::theme_pubr()
(delta_plot <- plot11 + plot12 + plot_layout(guides = "collect") & theme(legend.position = 'bottom') &  plot_annotation(tag_levels = 'a') )
ggsave("plots/delta_plot.png", delta_plot, units = 'cm', width = 20, height = 12)
shock_likelihood <- lapply(seq(30,80,10), function(t) read_csv(paste0('output/likelihood_baseline_100_', t , '.csv')))
names(shock_likelihood) <- seq(30,80,10)
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 50) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 30) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 30) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 30) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 50) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 30) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 50) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 50) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 40) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 30) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 35) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 34) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood <- lapply(seq(30,80,10), function(t) read_csv(paste0('output/likelihood__100_', t , '.csv')))
names(shock_likelihood) <- seq(30,80,10)
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 34) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 34) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood <- lapply(seq(30,80,10), function(t) read_csv(paste0('output/likelihood__100_', t , '.csv')))
names(shock_likelihood) <- seq(30,80,10)
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 50) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 50) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
#geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 50) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 50) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
coord_cartesian(expand = F) +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 50) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
coord_y_cartesian(expand = F) +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 50) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
coord_cartesian(expand = F, ylim = c(0,0.002)) +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 50) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
coord_cartesian(expand = F, ylim = c(0,0.02)) +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 50) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
coord_cartesian(expand = F, ylim = c(0.005,0.02)) +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 50) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('ev', 'cvar', 'mstd'), c("EV", "M-CVaR", "M-SD"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
coord_cartesian(expand = F, ylim = c(0.005,0.017)) +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
ggsave("plots/shock_likelihood_plot.png", units = 'cm', width = 12, height = 12)
shock_likelihood|>
bind_rows(.id='threshold') |>
filter(threshold == 50) |>
#filter(threshold %in% c(40,50,60)) |>
filter(alpha <= 30) |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('mstd', 'cvar', 'ev'), c("M-SD", "M-CVaR", "EV"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Probability", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
coord_cartesian(expand = F, ylim = c(0.005,0.017)) +
#facet_wrap(~threshold, scales = 'free_y') +
theme(legend.title = element_blank())
ggsave("plots/shock_likelihood_plot.png", units = 'cm', width = 12, height = 12)
contiguity |>
pivot_longer(c('mstd','cvar')) |>
mutate(name = factor(name, c('mstd', 'cvar', 'ev'), c("M-SD", "M-CVaR", "EV"))) |>
pivot_wider(names_from = var, values_from = value) |>
ggplot() +
#geom_hline(yintercept = 0, color = 'gray50') +
#geom_ribbon(aes(ymin = min, ymax = max, x = alpha, fill = name), alpha = 0.15) +
geom_hline(yintercept = 0, color = 'gray50') +
geom_ribbon(aes(ymin = lb, ymax = ub, x = alpha, fill = name), alpha = 0.2) +
geom_line(aes(x = alpha, y = median, color = name)) +
scale_x_continuous("θ") +
scale_y_continuous("Connectivity index", labels = scales::percent) +
ggsci::scale_color_nejm() +
ggsci::scale_fill_nejm() +
ggpubr::theme_pubr() +
coord_cartesian(expand = F) +
theme(legend.title = element_blank())
ggsave("plots/contiguity_plot.png", units = 'cm', width = 12, height = 12)
